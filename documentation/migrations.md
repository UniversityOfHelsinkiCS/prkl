# Migrations

Migration functionality is provided by `typeorm` and run always on backend start-up. See [TypeORM Documentation - Migrations](https://typeorm.io/#/migrations) for more information.

## Migration Files

Migration files are stored in `/server/src/migrations`.

## Auto-Generation

Migrations can be autogenerated with TypeORM CLI tool. This must be done against a current database, and so it is recommended to do it inside a running Docker container.

To begin, start the application:

```bash
docker-compose up
```

Then launch a shell inside the running container:

```bash
docker exec -ti prkl-dev /bin/bash
```

Make sure you are at `/usr/src/app/server` and generate the migrations, replacing `<NAME>` with a descriptive name for the migration:

```bash
npx ts-node node_modules/typeorm/cli.js migration:generate -n <NAME>
```

**Remember to double-check your migrations before committing - undoing them can be a real PITA!**
